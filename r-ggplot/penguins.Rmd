---
title: ""
output:
  html_document:
    theme: null
    highlight: null
    self_contained: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```

```{css, echo=FALSE}
html, body { margin: 0; padding: 0; width: 100%; height: 100%; }
.main-container { max-width: none !important; padding: 0 !important; }
.plotly.html-widget { width: 100% !important; height: 100% !important; }
```

```{r, fig.height=7, out.width="100%"}
library(tidyverse)
library(plotly)

penguins <- read_csv("../data/penglings.csv") %>% drop_na(bill_length_mm, body_mass_g, flipper_length_mm, species)

p <- ggplot(penguins, 
            aes(x = flipper_length_mm,
                y = body_mass_g,
                color = species,
                size = bill_length_mm,
                text = paste(
                    "Species:", species,
                    "<br>Flipper length:", flipper_length_mm, "mm",
                    "<br>Body mass:", body_mass_g, "g",
                    "<br>Bill length:", bill_length_mm, "mm"
                    )
                )) +
            geom_point(alpha = 0.7) +
            scale_size_continuous(
                range = c(2.5, 10),
                guide = "none"
            ) +
            labs(
                title = "Penguin Measurements: Flipper Length vs Body Mass",
                x = "Flipper Length (mm)",
                y = "Body Mass (g)",
                color = "Species"
            ) +
            theme_minimal(base_size = 12) +
            theme(
                plot.title = element_text(
                face = "bold",
                hjust = 0.5
                ),
                legend.position = "right",
                legend.title = element_text(face = "bold"),
                panel.grid.major = element_line(color = "#e6e6e6"),
                panel.grid.minor = element_blank()
            )

ggplotly(p, tooltip = "text") %>%
  layout(
    margin = list(l = 50, r = 50, t = 50, b = 20),
    autosize = TRUE
  ) %>%
  config(displayModeBar = FALSE, responsive = TRUE)
```